import{r as c,e as B}from"./index-DysCNOs_.js";import{T as pe,e as fe,u as be,s as ve,i as Z}from"./form-DbO9dA4O.js";import{O as Y,U as w,y as C,a as p,u as k,l as z,b as xe,h as ge,T as Oe,p as N,s as me,d as H,x as Re,C as D,I as V,c as Se,e as he,o as Le,f as ye,g as Ie,i as y,j as g,r as $e,k as W,m as Te,n as Pe}from"./keyboard-BayCKsX5.js";import{s as ke}from"./use-text-value-CqB0ebPQ.js";var we=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(we||{}),Ce=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Ce||{}),De=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(De||{}),Ee=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.RegisterLabel=7]="RegisterLabel",e))(Ee||{});function K(e,a=i=>i){let i=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,r=Pe(a(e.options.slice()),u=>u.dataRef.current.domRef.current),l=i?r.indexOf(i):null;return l===-1&&(l=null),{options:r,activeOptionIndex:l}}let Me={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let a=e.activeOptionIndex,{isSelected:i}=e.dataRef.current,r=e.options.findIndex(l=>i(l.dataRef.current.value));return r!==-1&&(a=r),{...e,listboxState:0,activeOptionIndex:a}},2(e,a){var i;if(e.dataRef.current.disabled||e.listboxState===1)return e;let r=K(e),l=Te(a,{resolveItems:()=>r.options,resolveActiveIndex:()=>r.activeOptionIndex,resolveId:u=>u.id,resolveDisabled:u=>u.dataRef.current.disabled});return{...e,...r,searchQuery:"",activeOptionIndex:l,activationTrigger:(i=a.trigger)!=null?i:1}},3:(e,a)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let i=e.searchQuery!==""?0:1,r=e.searchQuery+a.value.toLowerCase(),l=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+i).concat(e.options.slice(0,e.activeOptionIndex+i)):e.options).find(t=>{var n;return!t.dataRef.current.disabled&&((n=t.dataRef.current.textValue)==null?void 0:n.startsWith(r))}),u=l?e.options.indexOf(l):-1;return u===-1||u===e.activeOptionIndex?{...e,searchQuery:r}:{...e,searchQuery:r,activeOptionIndex:u,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,a)=>{let i={id:a.id,dataRef:a.dataRef},r=K(e,l=>[...l,i]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(a.dataRef.current.value)&&(r.activeOptionIndex=r.options.indexOf(i)),{...e,...r}},6:(e,a)=>{let i=K(e,r=>{let l=r.findIndex(u=>u.id===a.id);return l!==-1&&r.splice(l,1),r});return{...e,...i,activationTrigger:1}},7:(e,a)=>({...e,labelId:a.id})},q=c.createContext(null);q.displayName="ListboxActionsContext";function E(e){let a=c.useContext(q);if(a===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,E),i}return a}let J=c.createContext(null);J.displayName="ListboxDataContext";function M(e){let a=c.useContext(J);if(a===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,M),i}return a}function Ae(e,a){return k(a.type,Me,e,a)}let Fe=c.Fragment;function Qe(e,a){let{value:i,defaultValue:r,form:l,name:u,onChange:t,by:n=(s,d)=>s===d,disabled:b=!1,horizontal:O=!1,multiple:m=!1,...I}=e;const P=O?"horizontal":"vertical";let $=C(a),[R=m?[]:void 0,L]=pe(i,t,r),[v,o]=c.useReducer(Ae,{dataRef:c.createRef(),listboxState:1,options:[],searchQuery:"",labelId:null,activeOptionIndex:null,activationTrigger:1}),x=c.useRef({static:!1,hold:!1}),A=c.useRef(null),F=c.useRef(null),j=c.useRef(null),S=p(typeof n=="string"?(s,d)=>{let h=n;return(s==null?void 0:s[h])===(d==null?void 0:d[h])}:n),T=c.useCallback(s=>k(f.mode,{1:()=>R.some(d=>S(d,s)),0:()=>S(R,s)}),[R]),f=c.useMemo(()=>({...v,value:R,disabled:b,mode:m?1:0,orientation:P,compare:S,isSelected:T,optionsPropsRef:x,labelRef:A,buttonRef:F,optionsRef:j}),[R,b,m,v]);z(()=>{v.dataRef.current=f},[f]),xe([f.buttonRef,f.optionsRef],(s,d)=>{var h;o({type:1}),ge(d,Oe.Loose)||(s.preventDefault(),(h=f.buttonRef.current)==null||h.focus())},f.listboxState===0);let _=c.useMemo(()=>({open:f.listboxState===0,disabled:b,value:R}),[f,b,R]),ee=p(s=>{let d=f.options.find(h=>h.id===s);d&&G(d.dataRef.current.value)}),te=p(()=>{if(f.activeOptionIndex!==null){let{dataRef:s,id:d}=f.options[f.activeOptionIndex];G(s.current.value),o({type:2,focus:y.Specific,id:d})}}),oe=p(()=>o({type:0})),re=p(()=>o({type:1})),ne=p((s,d,h)=>s===y.Specific?o({type:2,focus:y.Specific,id:d,trigger:h}):o({type:2,focus:s,trigger:h})),ae=p((s,d)=>(o({type:5,id:s,dataRef:d}),()=>o({type:6,id:s}))),ie=p(s=>(o({type:7,id:s}),()=>o({type:7,id:null}))),G=p(s=>k(f.mode,{0(){return L==null?void 0:L(s)},1(){let d=f.value.slice(),h=d.findIndex(U=>S(U,s));return h===-1?d.push(s):d.splice(h,1),L==null?void 0:L(d)}})),le=p(s=>o({type:3,value:s})),se=p(()=>o({type:4})),ue=c.useMemo(()=>({onChange:G,registerOption:ae,registerLabel:ie,goToOption:ne,closeListbox:re,openListbox:oe,selectActiveOption:te,selectOption:ee,search:le,clearSearch:se}),[]),de={ref:$},Q=c.useRef(null),ce=N();return c.useEffect(()=>{Q.current&&r!==void 0&&ce.addEventListener(Q.current,"reset",()=>{L==null||L(r)})},[Q,L]),B.createElement(q.Provider,{value:ue},B.createElement(J.Provider,{value:f},B.createElement(me,{value:k(f.listboxState,{0:H.Open,1:H.Closed})},u!=null&&R!=null&&fe({[u]:R}).map(([s,d],h)=>B.createElement(be,{features:ve.Hidden,ref:h===0?U=>{var X;Q.current=(X=U==null?void 0:U.closest("form"))!=null?X:null}:void 0,...Re({key:s,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:l,disabled:b,name:s,value:d})})),D({ourProps:de,theirProps:I,slot:_,defaultTag:Fe,name:"Listbox"}))))}let Ue="button";function Be(e,a){var i;let r=V(),{id:l=`headlessui-listbox-button-${r}`,...u}=e,t=M("Listbox.Button"),n=E("Listbox.Button"),b=C(t.buttonRef,a),O=N(),m=p(v=>{switch(v.key){case g.Space:case g.Enter:case g.ArrowDown:v.preventDefault(),n.openListbox(),O.nextFrame(()=>{t.value||n.goToOption(y.First)});break;case g.ArrowUp:v.preventDefault(),n.openListbox(),O.nextFrame(()=>{t.value||n.goToOption(y.Last)});break}}),I=p(v=>{switch(v.key){case g.Space:v.preventDefault();break}}),P=p(v=>{if($e(v.currentTarget))return v.preventDefault();t.listboxState===0?(n.closeListbox(),O.nextFrame(()=>{var o;return(o=t.buttonRef.current)==null?void 0:o.focus({preventScroll:!0})})):(v.preventDefault(),n.openListbox())}),$=Z(()=>{if(t.labelId)return[t.labelId,l].join(" ")},[t.labelId,l]),R=c.useMemo(()=>({open:t.listboxState===0,disabled:t.disabled,value:t.value}),[t]),L={ref:b,id:l,type:Se(e,t.buttonRef),"aria-haspopup":"listbox","aria-controls":(i=t.optionsRef.current)==null?void 0:i.id,"aria-expanded":t.listboxState===0,"aria-labelledby":$,disabled:t.disabled,onKeyDown:m,onKeyUp:I,onClick:P};return D({ourProps:L,theirProps:u,slot:R,defaultTag:Ue,name:"Listbox.Button"})}let ze="label";function Ne(e,a){let i=V(),{id:r=`headlessui-listbox-label-${i}`,...l}=e,u=M("Listbox.Label"),t=E("Listbox.Label"),n=C(u.labelRef,a);z(()=>t.registerLabel(r),[r]);let b=p(()=>{var m;return(m=u.buttonRef.current)==null?void 0:m.focus({preventScroll:!0})}),O=c.useMemo(()=>({open:u.listboxState===0,disabled:u.disabled}),[u]);return D({ourProps:{ref:n,id:r,onClick:b},theirProps:l,slot:O,defaultTag:ze,name:"Listbox.Label"})}let He="ul",Ve=Y.RenderStrategy|Y.Static;function je(e,a){var i;let r=V(),{id:l=`headlessui-listbox-options-${r}`,...u}=e,t=M("Listbox.Options"),n=E("Listbox.Options"),b=C(t.optionsRef,a),O=N(),m=N(),I=he(),P=I!==null?(I&H.Open)===H.Open:t.listboxState===0;c.useEffect(()=>{var o;let x=t.optionsRef.current;x&&t.listboxState===0&&x!==((o=Le(x))==null?void 0:o.activeElement)&&x.focus({preventScroll:!0})},[t.listboxState,t.optionsRef]);let $=p(o=>{switch(m.dispose(),o.key){case g.Space:if(t.searchQuery!=="")return o.preventDefault(),o.stopPropagation(),n.search(o.key);case g.Enter:if(o.preventDefault(),o.stopPropagation(),t.activeOptionIndex!==null){let{dataRef:x}=t.options[t.activeOptionIndex];n.onChange(x.current.value)}t.mode===0&&(n.closeListbox(),W().nextFrame(()=>{var x;return(x=t.buttonRef.current)==null?void 0:x.focus({preventScroll:!0})}));break;case k(t.orientation,{vertical:g.ArrowDown,horizontal:g.ArrowRight}):return o.preventDefault(),o.stopPropagation(),n.goToOption(y.Next);case k(t.orientation,{vertical:g.ArrowUp,horizontal:g.ArrowLeft}):return o.preventDefault(),o.stopPropagation(),n.goToOption(y.Previous);case g.Home:case g.PageUp:return o.preventDefault(),o.stopPropagation(),n.goToOption(y.First);case g.End:case g.PageDown:return o.preventDefault(),o.stopPropagation(),n.goToOption(y.Last);case g.Escape:return o.preventDefault(),o.stopPropagation(),n.closeListbox(),O.nextFrame(()=>{var x;return(x=t.buttonRef.current)==null?void 0:x.focus({preventScroll:!0})});case g.Tab:o.preventDefault(),o.stopPropagation();break;default:o.key.length===1&&(n.search(o.key),m.setTimeout(()=>n.clearSearch(),350));break}}),R=Z(()=>{var o;return(o=t.buttonRef.current)==null?void 0:o.id},[t.buttonRef.current]),L=c.useMemo(()=>({open:t.listboxState===0}),[t]),v={"aria-activedescendant":t.activeOptionIndex===null||(i=t.options[t.activeOptionIndex])==null?void 0:i.id,"aria-multiselectable":t.mode===1?!0:void 0,"aria-labelledby":R,"aria-orientation":t.orientation,id:l,onKeyDown:$,role:"listbox",tabIndex:0,ref:b};return D({ourProps:v,theirProps:u,slot:L,defaultTag:He,features:Ve,visible:P,name:"Listbox.Options"})}let Ge="li";function Ke(e,a){let i=V(),{id:r=`headlessui-listbox-option-${i}`,disabled:l=!1,value:u,...t}=e,n=M("Listbox.Option"),b=E("Listbox.Option"),O=n.activeOptionIndex!==null?n.options[n.activeOptionIndex].id===r:!1,m=n.isSelected(u),I=c.useRef(null),P=ke(I),$=ye({disabled:l,value:u,domRef:I,get textValue(){return P()}}),R=C(a,I);z(()=>{if(n.listboxState!==0||!O||n.activationTrigger===0)return;let S=W();return S.requestAnimationFrame(()=>{var T,f;(f=(T=I.current)==null?void 0:T.scrollIntoView)==null||f.call(T,{block:"nearest"})}),S.dispose},[I,O,n.listboxState,n.activationTrigger,n.activeOptionIndex]),z(()=>b.registerOption(r,$),[$,r]);let L=p(S=>{if(l)return S.preventDefault();b.onChange(u),n.mode===0&&(b.closeListbox(),W().nextFrame(()=>{var T;return(T=n.buttonRef.current)==null?void 0:T.focus({preventScroll:!0})}))}),v=p(()=>{if(l)return b.goToOption(y.Nothing);b.goToOption(y.Specific,r)}),o=Ie(),x=p(S=>o.update(S)),A=p(S=>{o.wasMoved(S)&&(l||O||b.goToOption(y.Specific,r,0))}),F=p(S=>{o.wasMoved(S)&&(l||O&&b.goToOption(y.Nothing))}),j=c.useMemo(()=>({active:O,selected:m,disabled:l}),[O,m,l]);return D({ourProps:{id:r,ref:R,role:"option",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-selected":m,disabled:void 0,onClick:L,onFocus:v,onPointerEnter:x,onMouseEnter:x,onPointerMove:A,onMouseMove:A,onPointerLeave:F,onMouseLeave:F},theirProps:t,slot:j,defaultTag:Ge,name:"Listbox.Option"})}let We=w(Qe),qe=w(Be),Je=w(Ne),Xe=w(je),Ye=w(Ke),ot=Object.assign(We,{Button:qe,Label:Je,Options:Xe,Option:Ye});export{ot as I};
