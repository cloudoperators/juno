const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./App-Cvjo5eA6.js","./Shell-LkopxY2E.js","./index-BihIQf5W.js","./index-ChBQSB_h.js","./index-DcUN_fe3.css","./resourceStatus-B50ptR8S.js","./App-BjCYxW4b.js","./App-_ikFtO7n.js","./App-ByvO_BN7.js"])))=>i.map(i=>d[i]);
import{c as E,j as t,u as P,F as _,s as T,H as k,a as y,Q as N,V as L,t as z,q as C,A as O,L as V,b as w,d as I,G as W}from"./Shell-LkopxY2E.js";import{r as i}from"./index-BihIQf5W.js";import{_ as p}from"./index-ChBQSB_h.js";const R=()=>E(n=>({active:"",actions:{setActive:e=>n({active:e})}})),u=i.createContext(),F=({options:n,children:e})=>t.jsx(u.Provider,{value:R(),children:e}),b=n=>P(i.useContext(u),n),v=()=>b(n=>n.active),A=()=>b(n=>n.actions),f=i.lazy(()=>p(()=>import("./App-Cvjo5eA6.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),J=i.lazy(()=>p(()=>import("./App-BjCYxW4b.js"),__vite__mapDeps([6,1,2,3,4]),import.meta.url)),D=i.lazy(()=>p(()=>import("./App-_ikFtO7n.js"),__vite__mapDeps([7,1,2,3,4,5]),import.meta.url)),G=i.lazy(()=>p(()=>import("./App-ByvO_BN7.js"),__vite__mapDeps([8,1,2,3,4]),import.meta.url)),M=({apiEndpoint:n,auth:e})=>{var x,o,a,l;const s=v();let r;switch(s){case"clusters":r=f;break;case"secrets":r=J;break;case"plugins":r=D;break;case"teams":r=G;break;default:r=f}return e!=null&&e.JWT?t.jsx(_,{children:t.jsx(i.Suspense,{fallback:"Loading...",children:t.jsx(r,{apiEndpoint:n,token:e==null?void 0:e.JWT,namespace:(o=(x=e==null?void 0:e.parsed)==null?void 0:x.organizations)==null?void 0:o[0],expires:e==null?void 0:e.parsed.expiresAt,userGroup:(l=(a=e==null?void 0:e.parsed)==null?void 0:a.teams)==null?void 0:l[0],embedded:!0})})}):t.jsx("div",{children:"Authenticating"})},$="@tailwind base;@tailwind components;@tailwind utilities;.svg-bg-test{background:url(assets/juno-danger.svg)}",q=({apiEndpoint:n,auth:e})=>{var l;const[s,r]=i.useState(null),{addMessage:x}=T(),o=i.useMemo(()=>{var d,m;if(!((d=e==null?void 0:e.raw)!=null&&d.groups))return null;const c=(m=e==null?void 0:e.raw)==null?void 0:m.groups.find(S=>S.indexOf("organization:")===0);return c?c.split(":")[1]:null},[(l=e==null?void 0:e.raw)==null?void 0:l.groups]),a=i.useMemo(()=>!n||!(e!=null&&e.JWT)?null:k({apiEndpoint:n,token:e==null?void 0:e.JWT}),[n,e==null?void 0:e.JWT]);return i.useEffect(()=>{!a||!o||a.get(`/apis/greenhouse.sap/v1alpha1/organizations/${o}`).then(c=>{var d,m;r({name:(d=c==null?void 0:c.spec)==null?void 0:d.displayName,description:(m=c==null?void 0:c.spec)==null?void 0:m.description})}).catch(c=>{x({variant:"error",text:`Failed to fetch organization info. ${c.message}`})})},[a,o]),t.jsxs("div",{className:"org-info p-8 mb-8 bg-theme-background-lvl-0",children:[t.jsxs("div",{className:"org-name",children:[t.jsx("p",{className:"text-xs",children:"Organization"}),(s==null?void 0:s.name)&&t.jsx("h1",{className:"text-xl font-bold",children:s==null?void 0:s.name}),!(s!=null&&s.name)&&t.jsx("h1",{className:"text-xl font-bold",children:"Loading..."})]}),(s==null?void 0:s.description)&&t.jsx("p",{className:"org-description",children:s==null?void 0:s.description}),!(s!=null&&s.name)&&t.jsx("p",{className:"org-description"})]})},U=[{name:"clusters",label:"Clusters"},{name:"teams",label:"Teams"},{name:"plugins",label:"Plugins",beta:!0},{name:"secrets",label:"Secrets",beta:!0}],K=()=>{const n=v(),{setActive:e}=A();return t.jsx(y,{children:U.map((s,r)=>t.jsxs(N,{active:s.name===n,onClick:()=>e(s.name),children:[s.label," ",s.beta&&t.jsx(L,{text:"beta",variant:"info"})]},r))})},Q="greenhouse-org-admin",g="a",j=z(Q),Y=()=>{const{setActive:n}=A(),e=v();i.useLayoutEffect(()=>{var r;let s=(r=j.currentState())==null?void 0:r[g];s&&n(s)},[]),i.useEffect(()=>{var s;((s=j.currentState())==null?void 0:s[g])!==e&&j.push({[g]:e})},[e])},H=()=>(Y(),null),B=(n={})=>t.jsxs(t.Fragment,{children:[t.jsx(H,{}),t.jsxs(O,{"data-testid":"greenhouse-org-admin",children:[t.jsx(V,{className:"mb-4"}),t.jsx(q,{auth:n.auth,apiEndpoint:n.apiEndpoint}),t.jsx(w,{children:t.jsxs(I,{fullWidth:!0,children:[t.jsx(K,{}),t.jsx(W,{children:t.jsx(M,{...n})})]})})]})]}),ee=n=>t.jsxs(C,{theme:`${n.theme?n.theme:"theme-dark"}`,children:[t.jsx("style",{children:$.toString()}),t.jsx(_,{children:t.jsx(F,{options:n,children:t.jsx(B,{...n})})})]});export{ee as default};
