import{j as e,u as T,a as Z,b as F,d as V,e as _,s as k,H as D,C as o,v as r,K as d,x as v,f as O,r as E,c as x,W as H,l as K,h as m,g as M,i as P,k as z}from"./App-DNem0S8i-Ffrb2X9v.js";import{j as h}from"./_extensionId._-DGdCWYOQ.js";import{b as G,p as J,x as W,v as q,k as B,E as Q,y as N}from"./FirefoxCorsWarning-CN0e1CHQ-3WxyOetR.js";import"./index-VFlaALkv.js";import"./Shell-BWeNTCgI.js";import"./index-BDRnsyqe.js";const y=({timestamp:s})=>{let t;s.includes("T")?t=N.fromISO(s):t=N.fromSQL(s);const i=t.toFormat("yyyy-LL-dd HH:mm Z");return e.jsx("div",{children:i})},U=s=>s.length>40?s.substring(0,40)+"...":s,X=({silence:s},t)=>e.jsxs(o,{children:[e.jsxs(r,{className:"whitespace-nowrap",children:[e.jsx(y,{timestamp:s?.startsAt}),e.jsx(y,{timestamp:s?.endsAt})]}),e.jsxs(r,{className:"overflow-hidden",children:[e.jsx("div",{ref:t,children:s?.comment}),e.jsxs("div",{className:"text-theme-light",children:["Silence ",s.id," created by ",s?.createdBy]}),e.jsx(P,{className:"py-2 px-0",children:e.jsx(d,{gap:"2",alignment:"start",wrap:!0,children:s?.matchers?.map((i,j)=>e.jsx(z,{pillKey:i.name,pillValue:U(i.value)},j))})})]}),e.jsx(r,{className:"overflow-hidden",children:e.jsx("p",{children:s?.status?.state})}),e.jsx(r,{className:"overflow-hidden",children:s?.status?.state===x.SILENCE_ACTIVE||s?.status?.state===x.SILENCE_PENDING?e.jsx(B,{silence:s}):e.jsx(Q,{silence:s})})]}),Y=h.forwardRef(X),$=`
bg-theme-background-lvl-1
py-2
px-4
my-px
`,ee=()=>{const s=T(),t=Z(),[i,j]=h.useState(t),p=F(),l=V(),{setSilences:w,setSilencesStatus:C,setSilencesRegEx:u}=_(),{addMessage:S,resetMessages:L}=k(),{data:g,isLoading:I,error:f}=G("silences");f&&(L(),f instanceof J&&S({variant:"warning",text:e.jsx(W,{})}),S({variant:"error",text:q(f)})),h.useEffect(()=>{g&&w({items:g.silences})},[g]),h.useEffect(()=>{let a=t.filter(n=>n?.status?.state===p);try{l&&(a=a.filter(n=>JSON.stringify(n).match(new RegExp(l,"i"))))}catch(n){console.warn("search term is not a valid regex. "+n),a=a.filter(c=>JSON.stringify(c).toLowerCase().includes(l.toLowerCase))}j(a)},[p,l,t]);const b=a=>{const n=setTimeout(()=>{u(a.target.value),s({to:"/silences",search:c=>({...c,silencesRegEx:a.target.value})})},500);return()=>clearTimeout(n)},{scrollListItems:A,iterator:R}=D(i,{loadingObject:e.jsx(o,{children:e.jsx(r,{colSpan:3,children:e.jsxs(d,{gap:"3",alignment:"center",direction:"horizontal",children:["Loading...",e.jsx(v,{})]})})}),refFunction:a=>e.jsx(o,{children:e.jsx(r,{colSpan:3,className:"border-b-0 py-0",children:e.jsx("span",{ref:a})})})});return e.jsx(e.Fragment,{children:I?e.jsxs(d,{gap:"2",children:[e.jsx("span",{children:"Loading"}),e.jsx(v,{variant:"primary"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(d,{direction:"horizontal",className:`${$}`,children:[e.jsxs(O,{className:"w-3/12",label:"Status",value:p,onChange:a=>{C(a),s({to:"/silences",search:n=>({...n,silencesStatus:a})})},children:[e.jsx(E,{value:x.SILENCE_ACTIVE}),e.jsx(E,{value:x.SILENCE_PENDING}),e.jsx(E,{value:x.SILENCE_EXPIRED})]}),e.jsx(H,{placeholder:"search term or regular expression",className:"ml-auto w-7/12",value:l||"",onChange:a=>{b(a)},onSearch:a=>{u(a),s({to:"/silences",search:n=>({...n,silencesRegEx:a})})},onClear:()=>{u(null),s({to:"/silences",search:a=>{const{silencesRegEx:n,...c}=a;return{...c}}})}})]}),e.jsx(K,{columns:4,minContentColumns:[0,2,3],cellVerticalAlignment:"top",className:"silences ",children:e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Time intervall"}),e.jsx(m,{children:"Details"}),e.jsx(m,{children:"State"}),e.jsx(m,{children:"Action"})]}),A?.length?R.map(a=>e.jsx(Y,{silence:a},a.id)):e.jsx(o,{children:e.jsx(r,{colSpan:4,children:e.jsxs(d,{gap:"3",children:[e.jsx(M,{icon:"info",color:"text-theme-info"}),e.jsx("div",{children:"We couldn't find any matching silences."})]})})})]})})]})})};function le(){return e.jsx(ee,{})}export{le as component};
