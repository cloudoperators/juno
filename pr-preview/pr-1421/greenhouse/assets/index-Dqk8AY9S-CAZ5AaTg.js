import{j as e,E as u,X as k,Y as v,P as f,o as y,n as p,M as x,c as n,V as g,d as I}from"./App-vF9zOeeO-BmUu5RcU.js";import{G as d}from"./_extensionId._-CZlsEEn1.js";import{n as P}from"./SectionContentHeading-BughA7re-B54CX2Ef.js";import{f as w,b as D,a as j,n as m}from"./IssueCountsPerSeverityLevel-CaILDW4D-U8NTBIX4.js";import{g as S}from"./CursorPagination-CDSrorZj-Bc3E3PWO.js";const V=({imagesPromise:s,className:t})=>{const{data:i}=d.use(s),{totalImages:a}=x(i);return e.jsx("span",{className:t,children:a})},B=({version:s,selected:t=!1,displayDetailsButton:i=!0,onItemClick:a,onDetailClick:r})=>e.jsxs(y,{onClick:a,className:"cursor-pointer",isSelected:t,children:[e.jsx(n,{className:"service-image-versions-cell",children:e.jsxs(g,{gap:"1",direction:"vertical",children:[e.jsxs(g,{gap:"0.5",direction:"vertical",children:[e.jsx("span",{children:s.repository}),s.versionsCount!==void 0&&s.versionsCount>0&&e.jsxs("span",{className:"text-sm text-theme-light",children:[s.versionsCount," version",s.versionsCount!==1?"s":""]})]}),e.jsx(g,{gap:"1",alignment:"center",children:s.imageRegistryUrl&&e.jsx("a",{href:s.imageRegistryUrl.startsWith("http://")||s.imageRegistryUrl.startsWith("https://")?s.imageRegistryUrl:`https://${s.imageRegistryUrl}`,target:"_blank",rel:"noopener noreferrer",className:"hover:underline text-sm",onClick:l=>l.stopPropagation(),"aria-label":`Open image registry for ${s.repository} (opens in a new tab)`,title:`Open image registry for ${s.repository} (opens in a new tab)`,children:e.jsxs(g,{gap:"1.5",alignment:"center",children:[e.jsx(I,{icon:"openInNew",size:"16",color:"global-text"}),e.jsx("span",{children:"Image registry"})]})})})]})}),e.jsx(n,{className:"service-image-versions-cell",children:s.versionsCount!==void 0?`${s.versionsCount} version${s.versionsCount!==1?"s":""}`:"-"}),e.jsx(n,{className:"items-center !px-2",children:e.jsx(m,{severity:"critical",count:s.vulnerabilityCounts.critical,tooltipContent:"Critical Vulnerabilities"})}),e.jsx(n,{className:"items-center !px-2",children:e.jsx(m,{severity:"high",count:s.vulnerabilityCounts.high,tooltipContent:"High Vulnerabilities"})}),e.jsx(n,{className:"items-center !px-2",children:e.jsx(m,{severity:"medium",count:s.vulnerabilityCounts.medium,tooltipContent:"Medium Vulnerabilities"})}),e.jsx(n,{className:"items-center !px-2",children:e.jsx(m,{severity:"low",count:s.vulnerabilityCounts.low,tooltipContent:"Low Vulnerabilities"})}),e.jsx(n,{className:"items-center !px-2",children:e.jsx(m,{severity:"unknown",count:s.vulnerabilityCounts.none,tooltipContent:"None Vulnerabilities"})}),i&&e.jsx(n,{className:"cursor-default",onClick:l=>l.stopPropagation(),children:e.jsx(v,{size:"small",label:"Show Details",onClick:r,className:"whitespace-nowrap"})})]}),R=({columnSpan:s,selectedImage:t,displayDetailsButton:i,imagesPromise:a,onDetailsButtonClick:r,onImageItemClick:l})=>{const{error:o,data:b}=d.use(a),{images:h}=x(b);return o?e.jsx(j,{colSpan:s,children:"Error loading images."}):h.length===0?e.jsx(j,{colSpan:s,children:"No image found"}):h.map(c=>e.jsx(B,{version:c,selected:c.repository===t,displayDetailsButton:i,onItemClick:()=>{l?.(c)},onDetailClick:N=>{N.stopPropagation(),r?.(c)}},c.repository))},C=8,M=({imagesPromise:s,selectedImage:t,displayActions:i=!1,onImageItemClick:a,onDetailsButtonClick:r,goToPage:l})=>{const o=i?C:C-1;return e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:["Images",e.jsx(u,{children:e.jsxs(d.Suspense,{children:["(",e.jsx(V,{imagesPromise:s,className:"ml-1"}),")"]})})]}),i&&e.jsx(k,{children:e.jsx(v,{size:"small",onClick:()=>r?.(void 0),className:"whitespace-nowrap",children:"Full Details"})}),e.jsx("div",{className:"datagrid-hover",children:e.jsxs(f,{columns:o,minContentColumns:[2,3,4,5,6,7],children:[e.jsxs(y,{children:[e.jsx(p,{children:"Image Repository"}),e.jsx(p,{children:"Versions"}),e.jsx(p,{colSpan:5,children:"Vulnerability Counts"}),i&&e.jsx(p,{})]}),e.jsx(u,{displayErrorMessage:!0,resetKeys:[s],fallbackRender:w({colspan:o}),children:e.jsx(d.Suspense,{fallback:e.jsx(D,{colSpan:o}),children:e.jsx(R,{columnSpan:o,displayDetailsButton:i,imagesPromise:s,selectedImage:t,onDetailsButtonClick:r,onImageItemClick:a})})})]})}),e.jsx(u,{children:e.jsx(d.Suspense,{children:e.jsx(S,{dataNormalizationMethod:x,dataPromise:s,goToPage:l})})})]})};export{M as P};
