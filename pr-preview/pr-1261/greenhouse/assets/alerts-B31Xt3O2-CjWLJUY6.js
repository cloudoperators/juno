import{as as $e,at as dt,P as ke,p as G,j as e,au as Ee,ah as Ve,A as q,av as ht,u as M,S as Re,O as we,L as qe,T as ut,U as mt,Z as pt,_ as gt,$ as xt,a0 as Ae,a1 as _e,X as xe,H as re,r as _,o as S,s as v,V as N,m as Y,a2 as bt,a3 as ft,a4 as jt,a5 as vt,a6 as yt,aq as Nt,ar as kt,f as ae,e as Q,h as wt,K as Ct,g as P,i as St,k as $t,l as ze,n as se,w as W,B as ne,v as He,x as Et,y as At,z as Ke,a as Je,C as Ue,D as be,E as We,F as fe,I as L,J as je,Q as Ze,Y as Ce,W as Se,am as _t,an as Tt,ao as Ft,ap as Lt,a8 as It,N as Dt,q as U,t as le,M as Bt,c as Z,ai as Ot,a9 as Pt,aa as Mt,ab as Vt,ac as Rt,ad as qt,ae as zt,G as Ht,af as Kt,aj as ue,ak as Te,ag as Fe,a7 as Jt,al as me}from"./App-DNvk_pO2-PegnwIi9.js";import{j as y,V as R,$ as Ut}from"./_extensionId._-CInr31tj.js";import{o as ie,Z as Wt,c as Zt,l as oe,i as Gt,n as Yt,G as Qt,h as Ge,u as Ye,r as Xt,a as er}from"./FirefoxCorsWarning-1UfKTCr6-z6bp4lAx.js";import"./index-BAW8rA51.js";import"./Shell-7VPs4-pz.js";import"./index-B8Jz2Mjf.js";const tr=({severity:r},t)=>{const a=()=>{switch(r){case"critical":return"text-theme-danger";case"warning":return"text-theme-warning";case"info":return"text-theme-info"}};return e.jsx(e.Fragment,{children:r==="critical"?e.jsx(P,{ref:t,icon:"danger",color:a()}):r?.match(/^(warning|info)$/)?e.jsx(P,{icon:r,color:a(),ref:t}):e.jsx(P,{ref:t,icon:"errorOutline"})})},Qe=y.forwardRef(tr),Xe=({startTimestamp:r})=>{const t=new Date(r),a=(new Date().getTime()-t.getTime())/(1e3*60*60*24),s=t.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}),n=t.toLocaleString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZoneName:"short"});return e.jsxs(N,{direction:"vertical",gap:"1",children:[e.jsx("div",{children:s}),e.jsx("div",{children:n}),a>7&&e.jsxs(wt,{variant:"warning",triggerEvent:"hover",children:[e.jsx(Ct,{asChild:!0,children:e.jsx(P,{icon:"warning",color:"text-theme-warning"})}),e.jsx(St,{children:`Alert has been firing for ${Math.round(a)} days`})]})]})},f=1,et=2,tt=4,A=8,ve=16,X=32,I=64,ye={a:{content:f|A,self:!1,type:f|A|X|I},address:{invalid:["h1","h2","h3","h4","h5","h6","address","article","aside","section","div","header","footer"],self:!1},audio:{children:["track","source"]},br:{type:f|A,void:!0},body:{content:f|et|tt|A|ve|X|I},button:{content:A,type:f|A|X|I},caption:{content:f,parent:["table"]},col:{parent:["colgroup"],void:!0},colgroup:{children:["col"],parent:["table"]},details:{children:["summary"],type:f|X|I},dd:{content:f,parent:["dl"]},dl:{children:["dt","dd"],type:f},dt:{content:f,invalid:["footer","header"],parent:["dl"]},figcaption:{content:f,parent:["figure"]},footer:{invalid:["footer","header"]},header:{invalid:["footer","header"]},hr:{type:f,void:!0},img:{void:!0},li:{content:f,parent:["ul","ol","menu"]},main:{self:!1},ol:{children:["li"],type:f},picture:{children:["source","img"],type:f|A|ve},rb:{parent:["ruby","rtc"]},rp:{parent:["ruby","rtc"]},rt:{content:A,parent:["ruby","rtc"]},rtc:{content:A,parent:["ruby"]},ruby:{children:["rb","rp","rt","rtc"]},source:{parent:["audio","video","picture"],void:!0},summary:{content:A,parent:["details"]},table:{children:["caption","colgroup","thead","tbody","tfoot","tr"],type:f},tbody:{parent:["table"],children:["tr"]},td:{content:f,parent:["tr"]},tfoot:{parent:["table"],children:["tr"]},th:{content:f,parent:["tr"]},thead:{parent:["table"],children:["tr"]},tr:{parent:["table","tbody","thead","tfoot"],children:["th","td"]},track:{parent:["audio","video"],void:!0},ul:{children:["li"],type:f},video:{children:["track","source"]},wbr:{type:f|A,void:!0}};function z(r){return t=>{ye[t]={...r,...ye[t]}}}["address","main","div","figure","p","pre"].forEach(z({content:f,type:f|I}));["abbr","b","bdi","bdo","cite","code","data","dfn","em","i","kbd","mark","q","ruby","samp","strong","sub","sup","time","u","var"].forEach(z({content:A,type:f|A|I}));["p","pre"].forEach(z({content:A,type:f|I}));["s","small","span","del","ins"].forEach(z({content:A,type:f|A}));["article","aside","footer","header","nav","section","blockquote"].forEach(z({content:f,type:f|et|I}));["h1","h2","h3","h4","h5","h6"].forEach(z({content:A,type:f|tt|I}));["audio","canvas","iframe","img","video"].forEach(z({type:f|A|ve|I}));const Ne=Object.freeze(ye),rr=["applet","base","body","command","embed","frame","frameset","head","html","link","meta","noscript","object","script","style","title"],ar=Object.keys(Ne).filter(r=>r!=="canvas"&&r!=="iframe"),j=1,sr=2,J=3,K=4,rt=5,Le=Object.freeze({alt:j,cite:j,class:j,colspan:J,controls:K,datetime:j,default:K,disabled:K,dir:j,height:j,href:j,id:j,kind:j,label:j,lang:j,loading:j,loop:K,media:j,muted:K,poster:j,rel:j,role:j,rowspan:J,scope:j,sizes:j,span:J,start:J,style:rt,src:j,srclang:j,srcset:j,tabindex:j,target:j,title:j,type:j,width:j}),nr=Object.freeze({class:"className",colspan:"colSpan",datetime:"dateTime",rowspan:"rowSpan",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex"});function te(){return te=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])}return r},te.apply(this,arguments)}function at({attributes:r={},className:t,children:a=null,selfClose:s=!1,tagName:n}){const l=n;return s?R.createElement(l,te({className:t},r)):R.createElement(l,te({className:t},r),a)}class lr{attribute(t,a){return a}node(t,a){return a}}/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var pe,Ie;function ir(){if(Ie)return pe;Ie=1;var r=/["'&<>]/;pe=t;function t(a){var s=""+a,n=r.exec(s);if(!n)return s;var l,h="",o=0,u=0;for(o=n.index;o<s.length;o++){switch(s.charCodeAt(o)){case 34:l="&quot;";break;case 38:l="&amp;";break;case 39:l="&#39;";break;case 60:l="&lt;";break;case 62:l="&gt;";break;default:continue}u!==o&&(h+=s.substring(u,o)),u=o+1,h+=l}return u!==o?h+s.substring(u,o):h}return pe}var or=ir();const cr=Ut(or);var ee={};function O(r,t,a){return t in r?Object.defineProperty(r,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[t]=a,r}const dr=/(url|image|image-set)\(/i;class hr extends lr{attribute(t,a){return t==="style"&&Object.keys(a).forEach(s=>{String(a[s]).match(dr)&&delete a[s]}),a}}const De=1,ur=3,mr=/^<(!doctype|(html|head|body)(\s|>))/i,pr=/^(aria-|data-|\w+:)/iu,gr=/{{{(\w+)\/?}}}/;function xr(){if(!(typeof window>"u"||typeof document>"u"))return document.implementation.createHTMLDocument("Interweave")}class br{constructor(t,a={},s=[],n=[]){var l;if(O(this,"allowed",void 0),O(this,"banned",void 0),O(this,"blocked",void 0),O(this,"container",void 0),O(this,"content",[]),O(this,"props",void 0),O(this,"matchers",void 0),O(this,"filters",void 0),O(this,"keyIndex",void 0),ee.NODE_ENV!=="production"&&t&&typeof t!="string")throw new TypeError("Interweave parser requires a valid string.");this.props=a,this.matchers=s,this.filters=[...n,new hr],this.keyIndex=-1,this.container=this.createContainer(t||""),this.allowed=new Set((l=a.allowList)!==null&&l!==void 0?l:ar),this.banned=new Set(rr),this.blocked=new Set(a.blockList)}applyAttributeFilters(t,a){return this.filters.reduce((s,n)=>s!==null&&typeof n.attribute=="function"?n.attribute(t,s):s,a)}applyNodeFilters(t,a){return this.filters.reduce((s,n)=>s!==null&&typeof n.node=="function"?n.node(t,s):s,a)}applyMatchers(t,a){const s={},{props:n}=this;let l=t,h=0,o=null;return this.matchers.forEach(u=>{const m=u.asTag().toLowerCase(),i=this.getTagConfig(m);if(n[u.inverseName]||!this.isTagAllowed(m)||!this.canRenderChild(a,i))return;let c="";for(;l&&(o=u.match(l));){const{index:d,length:b,match:p,valid:$,void:F,...g}=o,T=u.propName+String(h);d>0&&(c+=l.slice(0,d)),$?(c+=F?`{{{${T}/}}}`:`{{{${T}}}}${p}{{{/${T}}}}`,this.keyIndex+=1,h+=1,s[T]={children:p,matcher:u,props:{...n,...g,key:this.keyIndex}}):c+=p,u.greedy?(l=c+l.slice(d+b),c=""):l=l.slice(d+(b||p.length))}u.greedy||(l=c+l)}),h===0?t:this.replaceTokens(l,s)}canRenderChild(t,a){return!t.tagName||!a.tagName||t.void?!1:t.children.length>0?t.children.includes(a.tagName):t.invalid.length>0&&t.invalid.includes(a.tagName)?!1:a.parent.length>0?a.parent.includes(t.tagName):!t.self&&t.tagName===a.tagName?!1:!!(t&&t.content&a.type)}convertLineBreaks(t){const{noHtml:a,disableLineBreaks:s}=this.props;if(a||s||t.match(/<((?:\/[ a-z]+)|(?:[ a-z]+\/))>/gi))return t;let n=t.replace(/\r\n/g,`
`);return n=n.replace(/\n{3,}/g,`


`),n=n.replace(/\n/g,"<br/>"),n}createContainer(t){var a;const s=(typeof global<"u"&&global.INTERWEAVE_SSR_POLYFILL||xr)();if(!s)return;const n=(a=this.props.containerTagName)!==null&&a!==void 0?a:"body",l=n==="body"||n==="fragment"?s.body:s.createElement(n);if(t.match(mr)){if(ee.NODE_ENV!=="production")throw new Error("HTML documents as Interweave content are not supported.")}else l.innerHTML=this.convertLineBreaks(this.props.escapeHtml?cr(t):t);return l}extractAttributes(t){const{allowAttributes:a}=this.props,s={};let n=0;return t.nodeType!==De||!t.attributes||([...t.attributes].forEach(l=>{const{name:h,value:o}=l,u=h.toLowerCase(),m=Le[u]||Le[h];if(!this.isSafe(t)||!u.match(pr)&&(!a&&(!m||m===sr)||u.startsWith("on")||o.replace(/(\s|\0|&#x0([9AD]);)/,"").match(/(javascript|vbscript|livescript|xss):/i)))return;let i=u==="style"?this.extractStyleAttribute(t):o;m===K?i=!0:m===J?i=Number.parseFloat(String(i)):m!==rt&&(i=String(i)),s[nr[u]||u]=this.applyAttributeFilters(u,i),n+=1}),n===0)?null:s}extractStyleAttribute(t){const a={};return Array.from(t.style).forEach(s=>{const n=t.style[s];(typeof n=="string"||typeof n=="number")&&(a[s.replace(/-([a-z])/g,(l,h)=>String(h).toUpperCase())]=n)}),a}getTagConfig(t){const a={children:[],content:0,invalid:[],parent:[],self:!0,tagName:"",type:0,void:!1};return Ne[t]?{...a,...Ne[t],tagName:t}:a}isSafe(t){if(typeof HTMLAnchorElement<"u"&&t instanceof HTMLAnchorElement){const a=t.getAttribute("href");if(a!=null&&a.startsWith("#"))return!0;const s=t.protocol.toLowerCase();return s===":"||s==="http:"||s==="https:"||s==="mailto:"||s==="tel:"}return!0}isTagAllowed(t){return this.banned.has(t)||this.blocked.has(t)?!1:this.props.allowElements||this.allowed.has(t)}parse(){return this.container?this.parseNode(this.container,this.getTagConfig(this.container.nodeName.toLowerCase())):[]}parseNode(t,a){const{noHtml:s,noHtmlExceptMatchers:n,allowElements:l,transform:h,transformOnlyAllowList:o}=this.props;let u=[],m="";return[...t.childNodes].forEach(i=>{if(i.nodeType===De){const d=i.nodeName.toLowerCase(),b=this.getTagConfig(d);m&&(u.push(m),m="");const p=this.applyNodeFilters(d,i);if(!p)return;let $;if(h&&!(o&&!this.isTagAllowed(d))){this.keyIndex+=1;const F=this.keyIndex;$=this.parseNode(p,b);const g=h(p,$,b);if(g===null)return;if(typeof g<"u"){u.push(R.cloneElement(g,{key:F}));return}this.keyIndex=F-1}if(this.banned.has(d))return;if(!(s||n&&d!=="br")&&this.isTagAllowed(d)&&(l||this.canRenderChild(a,b))){var c;this.keyIndex+=1;const F=this.extractAttributes(p),g={tagName:d};F&&(g.attributes=F),b.void&&(g.selfClose=b.void),u.push(R.createElement(at,{...g,key:this.keyIndex},(c=$)!==null&&c!==void 0?c:this.parseNode(p,b)))}else u=[...u,...this.parseNode(p,b.tagName?b:a)]}else if(i.nodeType===ur){const d=s&&!n?i.textContent:this.applyMatchers(i.textContent||"",a);Array.isArray(d)?u=[...u,...d]:m+=d}}),m&&u.push(m),u}replaceTokens(t,a){if(!t.includes("{{{"))return t;const s=[];let n=t,l=null;for(;l=n.match(gr);){const[h,o]=l,u=l.index,m=h.includes("/");if(ee.NODE_ENV!=="production"&&!a[o])throw new Error(`Token "${o}" found but no matching element to replace with.`);u>0&&(s.push(n.slice(0,u)),n=n.slice(u));const{children:i,matcher:c,props:d}=a[o];let b;if(m)b=h.length,s.push(c.createElement(i,d));else{const p=n.match(new RegExp(`{{{/${o}}}}`));if(ee.NODE_ENV!=="production"&&!p)throw new Error(`Closing token missing for interpolated element "${o}".`);b=p.index+p[0].length,s.push(c.createElement(this.replaceTokens(n.slice(h.length,p.index),a),d))}n=n.slice(b)}return n.length>0&&s.push(n),s.length===0?"":s.length===1&&typeof s[0]=="string"?s[0]:s}}function fr(r){var t;const{attributes:a,className:s,containerTagName:n,content:l,emptyContent:h,parsedContent:o,tagName:u,noWrap:m}=r,i=(t=n??u)!==null&&t!==void 0?t:"span",c=i==="fragment"?!0:m;let d;if(o)d=o;else{const b=new br(l??"",r).parse();b.length>0&&(d=b)}return d||(d=h),c?R.createElement(R.Fragment,null,d):R.createElement(at,{attributes:a,className:s,tagName:i},d)}const ce=({description:r,subdued:t})=>e.jsx(fr,{content:$t(r?.replace(/`([^`]+)`/g,"<code class='inline-code'>$1</code>")),tagName:"div",className:t?"text-theme-light":""}),st=({alert:r,className:t})=>e.jsxs(N,{gap:"3",className:t,children:[r?.generatorURL&&e.jsx("a",{className:"underline",href:r?.generatorURL,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"Prometheus"}),r?.labels?.playbook&&e.jsx("a",{className:"underline",href:r.labels.playbook.startsWith("http")?r.labels.playbook:`https://operations.global.cloud.sap/${r.labels.playbook}`,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"Playbook"}),r?.labels?.kibana&&e.jsx("a",{className:"underline",href:`https://logs.${r?.labels?.region}.cloud.sap/${r?.labels?.kibana}`,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"Logs"}),r?.labels?.dashboard&&e.jsx("a",{className:"underline",href:`https://plutono.${r?.labels?.region}.cloud.sap/d/${r?.labels?.dashboard}`,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"Plutono"}),r?.labels?.spc&&e.jsx("a",{className:"underline",href:`https://spc.ondemand.com/ticket_create/?${r?.labels?.spc}`,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"SPC Ticket"}),r?.labels?.sentry&&e.jsx("a",{className:"underline",href:`https://sentry.${r?.labels?.region}.cloud.sap/monsoon/${r?.labels?.sentry}`,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"Sentry"}),r?.labels?.cloudops&&e.jsx("a",{className:"underline",href:`https://dashboard.${r?.labels?.region}.cloud.sap/ccadmin/cloud_admin/cloudops#/universal-search/${r?.labels?.cloudops}`,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"CloudOps"}),r?.labels?.report&&e.jsx("a",{className:"underline",href:`https://dashboard.${r?.labels?.region}.cloud.sap/${r?.labels?.report}`,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"Report"}),r?.annotations?.mail_subject&&e.jsx("a",{className:"underline",href:`mailto:?subject=${encodeURIComponent(r?.annotations?.mail_subject)}&body=${encodeURIComponent(r?.annotations?.mail_body)}`,rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),children:"Email Owner"})]}),nt=({alert:r,showAll:t})=>{const a=M(),s=t?Object.keys(r?.labels):ze(),n=se(),{addActiveFilter:l,removeActiveFilter:h}=G(),o=(m,i,c)=>{n?.[i]?.includes(c)?u(m,i,c):(m.stopPropagation(),l(i,c),a({to:"/alerts",search:d=>le({...d},`${q}${i}`,c)}))},u=(m,i,c)=>{m.stopPropagation(),h(i,c),a({to:"/alerts",search:d=>U({...d},`${q}${i}`,c)})};return e.jsx(N,{gap:"2",alignment:"start",wrap:!0,children:s.map(m=>{const i=r?.labels?.[m],c=n?.[m]?.includes(i);return i&&e.jsx(W,{pillKey:m,pillValue:i,onClick:(d,b)=>o(d,m,i),closeable:c,onClose:(d,b)=>u(d,m,i)},m)})})},Be=({matchers:r,onClickCallback:t,closeable:a})=>{const s=y.useMemo(()=>!r||r?.length<=0?[]:r.sort((l,h)=>l.configurable-h.configurable),[r]),n=l=>{const h={onClick:()=>l.configurable&&t(l),onClose:()=>t(l)};return l.configurable?h:{}};return e.jsx(N,{gap:"2",alignment:"start",wrap:!0,children:s.length>0?r.map(l=>y.createElement(W,{className:l.configurable?"opacity-100":"opacity-70",closeable:l.configurable&&a,...n(l),key:l.name,pillKey:l.name,pillValue:l.value})):e.jsx("span",{className:"text-theme-light",children:"No excluded matchers found"})})},jr=r=>`
      transition-all
      ease-out
      max-h-0
      overflow-y-auto
			${r?"duration-1000 max-h-[34rem]":"duration-300"}
		`.replace(/\n/g," ").replace(/\s+/g," "),vr=({matchers:r,onMatchersChanged:t})=>{const[a,s]=y.useState(!1),n=l=>{l.preventDefault(),s(!a)};return e.jsx(e.Fragment,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"advance-link mt-4",children:e.jsx("a",{href:"#",rel:"noopener noreferrer",onClick:n,children:e.jsxs(N,{alignment:"center",children:["Advanced options",e.jsx(P,{color:"jn-global-text",icon:a?"expandLess":"expandMore"})]})})}),e.jsx("div",{className:"advanced-area overflow-hidden",children:e.jsxs("div",{className:jr(a),children:[e.jsx("p",{className:"mt-2",children:"Matchers attached to this silence"}),e.jsx("div",{className:"mt-2",children:e.jsx(Be,{matchers:r.filter(l=>!l.excluded),onClickCallback:t,closeable:!0})}),e.jsx("p",{className:"mt-4",children:"The default silence configuration excludes the following matchers because they typically make the silence too specific which can lead to alerts bypassing the silence unexpectedly. If you do want to include any of these matchers in the silence configuration, click on them to add them. If you change your mind, click again to remove."}),e.jsx("div",{className:"my-2",children:e.jsx(Be,{matchers:r.filter(l=>l.excluded),onClickCallback:t,closeable:!1})})]})})]})})},yr=r=>{const t={};return r?.comment?.length<3&&(t.comment||(t.comment=[]),t.comment.push("Please enter at least 3 characters")),r?.createdBy?.length<1&&(t.createdBy||(t.createdBy=[]),t.createdBy.push("Please enter a name")),t},Oe=r=>r.map((t,a)=>e.jsx("span",{className:"block text-theme-danger ",children:t},a)),Pe={duration:2,comment:""},lt=({alert:r,size:t,variant:a})=>{const s=He(),n=Et(),{getMappingSilences:l,setSilences:h}=Q(),o=At(),u=Ke(),[m,i]=y.useState(!1),[c,d]=y.useState(Pe),[b,p]=y.useState(null),[$,F]=y.useState({}),{addMessage:g}=ae(),T=Je(),D=x=>{const w=new Date(x),B=w.toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"}),V=w.toLocaleString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZoneName:"short"});return`${B} ${V}`};y.useLayoutEffect(()=>{d({...c,...Pe,createdBy:u||"",matchers:Gt(r?.labels,n,o)}),p(Yt(l(r))),F({})},[m]);const H=y.useMemo(()=>{const x=Qt(b??0);return x.firstNotCovered&&d({...c,duration:x.firstNotCovered.value}),x.items},[b]),{mutate:de}=Ge("createSilences",{onMutate:x=>{s.cancelQueries({queryKey:["silences"]});const w={...x.silence,status:{state:Z.SILENCE_ACTIVE}},B=[...T,w];h({items:B}),i(!1)},onSuccess:x=>{g({variant:"success",text:`A silence object with id ${x?.silenceID} was created successfully. Please note that it may
            take up to 5 minutes for the alert to show up as silenced.`})},onError:x=>{g({variant:"error",text:oe(x)})},onSettled:()=>{s.invalidateQueries({queryKey:["silences"]})}}),k=Ye(()=>{const x=yr(c);if(F(x),Object.keys(x).length>0)return;const w={...c};w.matchers?.length>0&&(w.matchers=w.matchers.filter(he=>!he.excluded).map(({...he})=>he));const B=new Date,V=new Date;V.setHours(V.getHours()+Number.parseInt(w.duration||4));const ct={...w,status:{state:Z.SILENCE_ACTIVE},startsAt:B.toISOString(),endsAt:V.toISOString(),alertFingerprint:r.fingerprint};de({silence:ct})},200),C=({key:x,value:w})=>{w&&d({...c,[x]:w})},E=x=>{const w=c.matchers.findIndex(V=>V.name==x.name),B=c.matchers.slice();w>=0&&(B[w]={...B[w],excluded:!x.excluded}),d({...c,matchers:B})};return e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:t,variant:a,onClick:x=>{x.stopPropagation(),i(!m)},children:"Silence"}),m&&e.jsxs(Ue,{title:"New Silence for",size:"large",open:!0,confirmButtonLabel:"Save",onCancel:()=>i(!1),onConfirm:k,children:[b&&e.jsxs(be,{className:"mb-6",variant:"info",children:["There is already a silence for this alert that expires at",e.jsxs("b",{children:[" ",D(b)]})]}),e.jsx("span",{className:"text-lg font-bold",children:r?.labels?.alertname}),e.jsx(We,{className:"mt-2",children:e.jsx(ce,{description:r.annotations?.description})}),e.jsxs(e.Fragment,{children:[e.jsx(vr,{matchers:c.matchers,onMatchersChanged:E}),e.jsxs(fe,{className:"mt-6",children:[e.jsx(L,{children:e.jsx(je,{required:!0,label:"Silenced by",value:c.createdBy,onChange:x=>C({key:"createdBy",value:x.target.value}),errortext:$.createdBy&&Oe($.createdBy),disabled:!!u})}),e.jsx(L,{children:e.jsx(Ze,{className:"h-20",label:"Description",value:c.comment,onChange:x=>C({key:"comment",value:x.target.value}),errortext:$.comment&&Oe($.comment),required:!0})}),e.jsx(L,{children:e.jsx(Ce,{required:!0,label:"Duration",value:c.duration,onChange:x=>C({key:"duration",value:x}),children:H?.map(x=>e.jsx(Se,{label:x.label,value:String(x.value)},x.value))})})]})]})]})]})},Nr=(r,t)=>{if(!r)return null;const a=r.map(s=>t.find(n=>n.fingerprint===s));return a[0]?a.sort((s,n)=>new Date(n.endsAt).getTime()-new Date(s.endsAt).getTime())[0]:null},it=({alert:r})=>{if(!r)return null;const t=qe(),{getMappingSilences:a}=Q(),s=a(r).sort((h,o)=>new Date(o?.endsAt).getTime()-new Date(h?.endsAt).getTime()),n=s.length>0?s[0]:null,l=Nr(r?.status?.inhibitedBy,t);return e.jsxs("div",{className:"cursor-default",children:[r&&e.jsx("span",{children:r?.status?.state}),l&&e.jsx("div",{className:"text-xs mt-2",children:e.jsxs(N,{direction:"vertical",children:[e.jsx("span",{children:"Inhibited by:"}),e.jsx("span",{children:l?.annotations?.summary})]})}),n&&e.jsx("div",{className:"text-xs mt-2",children:e.jsxs(N,{direction:"vertical",children:[e.jsx("span",{children:"Silenced by:"}),e.jsx("span",{children:n?.createdBy||n.id},n.id)]})})]})},ot=({region:r,cluster:t})=>e.jsxs(e.Fragment,{children:[r,r!==t&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{className:"text-theme-light",children:t})]})]}),kr=r=>{switch(r){case Z.SILENCE_ACTIVE:return"info";default:return"default"}},wr=({alert:r})=>{const{getSilencesForAlert:t}=Q(),a=t(r),s=n=>new Date(n).toLocaleString("en-GB",{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1});return e.jsx(e.Fragment,{children:a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-bold mb-2 mt-8",children:"Silences"}),e.jsxs(re,{columns:6,minContentColumns:[5],children:[e.jsxs(_,{children:[e.jsx(S,{children:"Status"}),e.jsx(S,{children:"Silence start"}),e.jsx(S,{children:"Silence end"}),e.jsx(S,{children:"Created by"}),e.jsx(S,{children:"Comment"}),e.jsx(S,{children:"Action"})]}),a.map(n=>e.jsxs(_,{children:[e.jsx(v,{children:e.jsx("div",{children:e.jsx(Bt,{variant:kr(n?.status?.state),children:n.status?.state})})}),e.jsx(v,{children:s(n.startsAt)}),e.jsx(v,{children:s(n.endsAt)}),e.jsx(v,{children:n.createdBy}),e.jsx(v,{className:"break-all",children:n.comment}),e.jsx(v,{children:n?.status?.state===Z.SILENCE_ACTIVE?e.jsx(Xt,{silence:n,fingerprint:r.fingerprint}):e.jsx(er,{silence:n,fingerprint:r.fingerprint})})]},n.id))]})]})})},Cr=({alert:r})=>{const t=M(),{getAlertByFingerprint:a}=we(),{setShowDetailsFor:s}=ke(),{setSilences:n}=Q(),{addMessage:l}=ae(),{error:h,data:o,isLoading:u}=ie("silences");return y.useEffect(()=>{o&&n({items:o?.silences})},[o]),h&&l({variant:"error",text:oe(h)}),e.jsxs(xe,{py:!0,px:!1,children:[u?e.jsxs(N,{gap:"2",children:[e.jsx("span",{children:"Loading"}),e.jsx(Y,{variant:"primary"})]}):e.jsx(wr,{alert:r}),r.status.inhibitedBy.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-bold mb-2 mt-8",children:"Inhibited by"}),e.jsxs(re,{columns:2,children:[e.jsxs(_,{children:[e.jsx(S,{children:"Alert"}),e.jsx(S,{})]}),r.status.inhibitedBy.map(m=>e.jsxs(_,{children:[e.jsxs(v,{children:[e.jsx("div",{children:a(m)?.annotations?.summary}),e.jsx(ce,{description:a(m)?.annotations?.description})]}),e.jsx(v,{children:e.jsx(ne,{size:"small",onClick:()=>{s(m),t({to:"/",search:i=>({...i,showDetailsFor:m})})},icon:"exitToApp",children:"Go to details"})})]},m))]})]})]})},Sr=()=>{const r=M(),t=Re(),{setShowDetailsFor:a}=ke(),{getAlertByFingerprint:s}=we(),[n,l]=y.useState(void 0),h=qe(),o=()=>{a(null),r({to:"/alerts",search:m=>{const{showDetailsFor:i,...c}=m;return{...c}}})},{isLoading:u}=ie("alerts");return y.useEffect(()=>{h?.length>0&&l(s(t))},[h,t]),e.jsxs(ut,{heading:e.jsxs(N,{gap:"2",children:[e.jsx(Qe,{severity:n?.labels?.severity}),e.jsx("span",{children:n?.annotations?.summary||"Not found"})]}),opened:!!t,onClose:o,size:"large",children:[e.jsxs(mt,{children:[e.jsx(pt,{className:"pb-6 absolute"}),e.jsxs(gt,{children:[e.jsxs(xt,{children:[e.jsx(Ae,{children:"Details"}),e.jsx(Ae,{children:"Raw Data"})]}),e.jsx(_e,{children:e.jsx(xe,{px:!1,py:!0,children:n?e.jsxs(e.Fragment,{children:[e.jsxs(re,{columns:2,children:[e.jsxs(_,{children:[e.jsx(S,{children:"Status"}),e.jsx(v,{children:e.jsx(it,{alert:n})})]}),e.jsxs(_,{children:[e.jsx(S,{children:"Firing Since"}),e.jsx(v,{children:e.jsx(Xe,{startTimestamp:n?.startsAt})})]}),e.jsxs(_,{children:[e.jsx(S,{children:"Service"}),e.jsx(v,{children:n?.labels?.service})]}),e.jsxs(_,{children:[e.jsx(S,{children:"Region"}),e.jsx(v,{children:e.jsx(ot,{region:n?.labels?.region,cluster:n?.labels?.cluster})})]}),e.jsxs(_,{children:[e.jsx(S,{children:"Description"}),e.jsx(v,{children:e.jsx(ce,{description:n?.annotations?.description})})]}),e.jsxs(_,{children:[e.jsx(S,{children:"Links"}),e.jsx(v,{children:e.jsx(st,{alert:n})})]}),e.jsxs(_,{children:[e.jsx(S,{children:"Labels"}),e.jsx(v,{children:e.jsx(nt,{alert:n,showAll:!0})})]})]}),e.jsx(Cr,{alert:n})]}):u?e.jsxs(N,{gap:"2",children:[e.jsx("span",{children:"Loading"}),e.jsx(Y,{variant:"primary"})]}):"Not found - the alert is probably not firing at the moment"})}),e.jsx(_e,{children:e.jsx(xe,{px:!1,py:!0,children:e.jsx(bt,{children:n&&e.jsx(ft,{data:n,expanded:!0})})})})]})]}),e.jsx(jt,{children:n&&e.jsx(lt,{alert:n,variant:"primary"})})]})},$r=(r,t)=>{let a=`
    text-lg/5
  `;if(!t||t<1)return`${a} text-theme-light`;switch(r){case"critical":a+=" bg-theme-danger/50";break;case"warning":a+=" bg-theme-warning/50";break;case"info":a+=" bg-theme-info/40";break}return a},Er=(r,t)=>r?t?r-t:r:"--",ge=({severity:r,severityCountTotal:t,severityCountSuppressed:a})=>e.jsxs(N,{direction:"vertical",alignment:"stretch",distribution:"center",className:$r(r,t),children:[e.jsx(N,{direction:"vertical",alignment:"center",distribution:"center",className:"h-full",children:Er(t,a)}),a&&e.jsx("div",{className:"text-xs bg-black/10 mt-auto",children:e.jsxs(N,{alignment:"center",distribution:"center",children:[e.jsx(P,{icon:"notificationsOff",size:"0.75rem"}),e.jsx("span",{children:a})]})})]}),Ar=`
  grid
  grid-cols-[repeat(4,_minmax(5rem,_1fr))]

  group
  bg-theme-background-lvl-1
  hover:bg-theme-background-lvl-2
  hover:text-theme-high
  cursor-pointer
`,_r=`
  bg-theme-background-lvl-2
  group-hover:bg-theme-background-lvl-3
  font-bold
  px-3
  py-2
  whitespace-nowrap
`,Tr=({region:r,severityCounts:t})=>{const a=M(),{addActiveFilter:s,removeActiveFilter:n}=G(),l=se(),h=()=>{l?.region?.includes(r)?(n("region",r),a({to:"/alerts",search:o=>U({...o},`${q}region`,r)})):(s("region",r),a({to:"/alerts",search:o=>le({...o},`${q}region`,r)}))};return e.jsxs("div",{className:`region ${Ar}`,onClick:()=>h(),children:[e.jsx(N,{alignment:"center",distribution:"center",className:_r,children:r||"Counts"}),e.jsx(ge,{severity:"critical",severityCountTotal:t?.critical?.total,severityCountSuppressed:t?.critical?.suppressed}),e.jsx(ge,{severity:"warning",severityCountTotal:t?.warning?.total,severityCountSuppressed:t?.warning?.suppressed}),e.jsx(ge,{severity:"info",severityCountTotal:t?.info?.total,severityCountSuppressed:t?.info?.suppressed})]})},Fr=`
  grid
  auto-rows-fr
  grid-cols-[repeat(auto-fit,_minmax(21rem,_1fr))]
  gap-3
  mb-8
`,Lr=()=>{const{isLoading:r}=ie("alerts"),t=vt(),a=yt(),s=()=>!r&&a?e.jsx("div",{className:`regions ${Fr}`,children:a.map(n=>e.jsx(Tr,{region:n,severityCounts:t[n]},`${n}`))}):null;return e.jsx(e.Fragment,{children:s()})},Ir=r=>{let t="border-text-theme-default";switch(r){case"critical":t="border-theme-danger";break;case"warning":t="border-theme-warning";break;case"info":t="border-theme-info";break}return`
    border-l-2
    ${t}
    h-full
    pl-5
  `},Dr=({alert:r},t)=>{const a=M(),{showDetailsFor:s}=Jt({from:"/alerts"}),n=y.useRef(null),l=h=>{h.target.parentNode!==n.current&&!h.target.classList.contains("interactive")&&!h.target.closest(".interactive")||(h.stopPropagation(),h.preventDefault(),a({to:"/alerts",search:o=>({...o,showDetailsFor:s!==r?.fingerprint?r?.fingerprint:void 0})}))};return e.jsxs(_,{className:`cursor-pointer ${Re()===r?.fingerprint?"active":""}`,ref:n,onClick:h=>l(h),children:[e.jsx(v,{className:"pl-0 interactive",children:e.jsx("div",{className:Ir(r.labels?.severity),children:e.jsx(Qe,{ref:t,severity:r.labels?.severity})})}),e.jsx(v,{className:"interactive",children:e.jsx(ot,{region:r.labels?.region,cluster:r.labels?.cluster})}),e.jsx(v,{children:r.labels?.service}),e.jsxs(v,{className:"cursor-default",children:[e.jsx("div",{className:"interactive text-theme-high cursor-pointer",children:r.annotations?.summary}),e.jsxs("div",{children:[e.jsx(ce,{description:r.annotations?.description,subdued:!0}),e.jsx(st,{alert:r,className:"mb-4 mt-1"})]}),e.jsx(nt,{alert:r})]}),e.jsx(v,{className:"interactive",children:e.jsx(Xe,{startTimestamp:r.startsAt})}),e.jsx(v,{children:e.jsx(it,{alert:r})}),e.jsx(v,{children:e.jsx(lt,{alert:r,size:"small"})})]})},Br=y.forwardRef(Dr),Or=()=>{const r=It(),{scrollListItems:t,iterator:a}=Dt(r,{loadingObject:e.jsx(_,{children:e.jsx(v,{colSpan:3,children:e.jsxs(N,{gap:"3",alignment:"center",direction:"horizontal",children:["Loading...",e.jsx(Y,{})]})})}),refFunction:s=>e.jsx(_,{children:e.jsx(v,{colSpan:3,className:"border-b-0 py-0",children:e.jsx("span",{ref:s})})})});return e.jsxs(re,{columns:7,minContentColumns:[0,2,5],cellVerticalAlignment:"top",className:"alerts",children:[e.jsxs(_,{children:[e.jsx(S,{children:e.jsx(P,{icon:"monitorHeart"})}),e.jsx(S,{children:"Region"}),e.jsx(S,{children:"Service"}),e.jsx(S,{children:"Description"}),e.jsx(S,{children:"Firing Since"}),e.jsx(S,{children:"Status"}),e.jsx(S,{})]}),t?.length?a.map(s=>e.jsx(Br,{alert:s},s.fingerprint)):e.jsx(_,{className:"no-hover",children:e.jsx(v,{colSpan:7,children:e.jsxs(N,{gap:"3",children:[e.jsx(P,{icon:"info",color:"text-theme-info"}),e.jsx("div",{children:"We couldn't find anything. It's possible that the matching alerts are not active at the moment, or the chosen filters could be overly limiting."})]})})})]})},Pr=`
  bg-theme-background-lvl-1
  py-1.5
  px-4
  my-px
  text-theme-light
`,Mr=({totalCounts:r,isUpdating:t,updatedAt:a})=>{const s=n=>new Date(n).toLocaleString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZoneName:"short"});return e.jsxs(N,{className:`status-bar ${Pr}`,alignment:"center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-theme-default pr-2",children:`${r.total} alerts`}),e.jsx("span",{children:`(${r.critical||0} critical, ${r.warning||0} warning, ${r.info||0} info)`})]}),e.jsxs(N,{alignment:"center",className:"ml-auto",children:[t&&e.jsx(Y,{size:"small",className:"mr-2"}),a&&`updated ${s(a)}`]})]})},Vr=()=>{const r=M(),[t,a]=y.useState(""),[s,n]=y.useState(""),{addActiveFilter:l,loadFilterLabelValues:h,clearFilters:o,setSearchTerm:u}=G(),m=ze(),i=Pt(),c=se(),d=Mt(),b=g=>{a(g),i[g]?.values||h(g)},p=g=>{n(g),t.trim()!==""&&g.trim()!==""&&(l(t,g),r({to:"/alerts",search:T=>le({...T},`${q}${t}`,g)})),setTimeout(()=>{n("")},0)},$=g=>{const T=setTimeout(()=>{u(g.target.value),r({to:"/alerts",search:D=>({...D,searchTerm:g.target.value.trim()})})},500);return()=>clearTimeout(T)};return e.jsxs(N,{alignment:"center",gap:"8",children:[e.jsxs(Vt,{children:[e.jsx(Ce,{name:"filter",className:"filter-label-select w-64 mb-0",label:"Filter",value:t,onChange:g=>b(g),children:m?.map(g=>e.jsx(Se,{value:g,label:Rt(g)},g))}),e.jsx(qt,{value:s,name:"filterValue",onChange:g=>p(g),disabled:!i[t],loading:i[t]?.isLoading,className:"filter-value-select w-96 bg-theme-background-lvl-0",children:i[t]?.values?.filter(g=>!c[t]?.includes(g)).slice(0,100).map(g=>e.jsx(zt,{value:g},g))})]}),F(),e.jsx(Ht,{placeholder:"search term or regular expression",className:"w-96 ml-auto",value:d||"",onSearch:g=>u(g),onClear:()=>{u(""),r({to:"/alerts",search:g=>({...g,searchTerm:""})})},onChange:g=>$(g)})]});function F(){return c&&Object.keys(c).length>0&&e.jsx(ne,{label:"Clear all",onClick:()=>{o(),r({to:"/alerts",search:g=>Object.entries(g).reduce((T,[D,H])=>(H&&!D.startsWith("f_")&&!D.startsWith("pf_")&&(T[D]=H),T),{})})},variant:"subdued"})}},Rr=()=>{const r=M(),t=se(),a=Kt(),{removeActiveFilter:s,addActiveFilter:n,addPausedFilter:l,removePausedFilter:h}=G(),o=(i,c)=>{l(i,c),r({to:"/alerts",search:d=>({...d,...Ve("pf_",le(a,i,c))})})},u=(i,c)=>{s(i,c),h(i,c),r({to:"/alerts",search:d=>{const b=U({...d},`${q}${i}`,c);return U({...b},`${Fe}${i}`,c)}})},m=(i,c)=>{n(i,c),h(i,c),r({to:"/alerts",search:d=>U({...d},`${Fe}${i}`,c)})};return e.jsx(N,{gap:"2",wrap:!0,children:Object.entries(t).map(([i,c])=>c?.map(d=>a[i]?.includes(d)?e.jsx(W,{className:"bg-theme-background-lvl-4 opacity-70",pillKey:i,pillValue:d,closeable:!0,onClose:()=>u(i,d),onClick:()=>m(i,d)},`${i}:${d}`):e.jsx(W,{pillKey:i,pillValue:d,closeable:!0,onClose:()=>u(i,d),onClick:()=>o(i,d)},`${i}:${d}`)))})},qr=`
  bg-theme-background-lvl-1
  py-2
  px-4
  my-px
`,zr=()=>e.jsxs(N,{direction:"vertical",gap:"4",className:`filters ${qr}`,children:[e.jsx(Vr,{}),e.jsx(Rr,{})]}),Hr=r=>{let t=r,a=!1;return t.comment.value.length<3&&(a=!0,t={...t,comment:{...t.comment,error:"Please enter at least 3 characters"}}),(!t?.createdBy?.value||t?.createdBy?.value.length<1)&&(a=!0,t={...t,createdBy:{...t.createdBy,error:"Created by cannot be empty"}}),new Date(t.date.start)>=new Date(t.date.end)&&(a=!0,t={...t,date:{...t.date,error:"The start date need to be before the end date"}}),Object.keys(t.editable_labels).map(s=>{Kr(t.editable_labels[s].value)||(a=!0,t={...t,editable_labels:{...t.editable_labels,[s]:{...t.editable_labels[s],error:`Value for ${s} is not a valid regular expression`}}}),t.editable_labels[s]?.value||(a=!0,t={...t,editable_labels:{...t.editable_labels,[s]:{...t.editable_labels[s],error:`Value for ${s} is empty`}}})}),a?t:null},Kr=r=>{try{return!!new RegExp(r)}catch(t){return console.error(t),!1}},Me={fixed_labels:{},editable_labels:{},comment:{value:"",error:null},createdBy:{value:"",error:null},date:{start:null,end:null,error:null}},Jr=()=>{const r=Ke(),{addMessage:t}=ae(),a=Ot(),[s,n]=y.useState(null),l=He(),h=Je(),{setSilences:o}=Q(),[u,m]=y.useState(null),i=y.useMemo(()=>{const k=new Date;return`${k.getFullYear()}-${k.getMonth()+1}-${k.getDate()}`},[]),[c,d]=y.useState(Me),[b,p]=y.useState(!0),{mutate:$}=Ge("createSilences",{onMutate:k=>{l.cancelQueries({queryKey:["silences"]});const C={...k.silence,status:{state:Z.SILENCE_ACTIVE}},E=[...h,C];o({items:E})},onSuccess:k=>{p(!0),t({variant:"success",text:`A silence object with id ${k?.silenceID} was created successfully. Please note that it may take up
          to 5 minutes for the alert to show up as silenced.`})},onError:k=>{n(oe(k))},onSettled:()=>{l.invalidateQueries({queryKey:["silences"]})}}),F=Ye(()=>{n(null);const k=Hr(c);if(k){d(k),n("Please fix the errors in the form");return}const C={startsAt:c.date.start,endsAt:c.date.end,comment:c.comment.value,createdBy:c.createdBy.value,matchers:[]};for(const[E,x]of Object.entries(c.editable_labels)){const w={name:E,value:x.value,isRegex:!0};C.matchers.push(w)}for(const[E,x]of Object.entries(c.fixed_labels)){const w={name:E,value:x,isRegex:!0};C.matchers.push(w)}$({silence:C})},200),g=k=>{const C=a.find(x=>x.id===k),E={...Me,fixed_labels:C?.fixed_labels||{},createdBy:{value:r,error:null},editable_labels:C?.editable_labels?.reduce((x,w)=>({...x,[w]:{value:"",error:null}}),{})};d(E),m(C)},T=({key:k,value:C})=>{d({...c,[k]:{value:C,error:null}})},D=k=>{const C=k.target.id;d(me(E=>{E.editable_labels[C].value=k.target.value,E.editable_labels[C].error=null}))},H=(k,C)=>{d(me(E=>{E.date.start=C,E.date.error=null}))},de=(k,C)=>{d(me(E=>{E.date.end=C,E.date.error=null}))};return e.jsx(e.Fragment,{children:Ur(a,p,b,u,F,s,g,c,T,r,i,H,de,D)})};function Ur(r,t,a,s,n,l,h,o,u,m,i,c,d,b){return r&&r?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{onClick:p=>{p.stopPropagation(),t(!1)},children:"Schedule Silence"}),!a&&e.jsxs(Ue,{title:"Schedule new silence",size:"large",open:!0,confirmButtonLabel:!s||s?.invalid?void 0:"Save",onConfirm:!s||s?.invalid?void 0:n,onCancel:()=>t(!0),children:[l&&e.jsx(be,{text:l,variant:"danger"}),e.jsxs(fe,{className:"mt-6",children:[s&&s?.invalid&&e.jsx(L,{children:e.jsx(be,{text:`This silence template is invalid. ${s.invalid}`,variant:"error"})}),e.jsx(L,{children:e.jsx(Ce,{required:!0,label:"Silence Template",value:s?.id||"Select",onValueChange:p=>{h(p)},children:r?.map(p=>e.jsx(Se,{id:p.id,label:p.title,value:p.id},p.id))})}),s&&!s?.invalid&&e.jsx(L,{children:e.jsx(We,{children:s?.description})})]}),s&&!s?.invalid&&e.jsxs(fe,{children:[e.jsxs(ue,{children:[e.jsx(L,{children:e.jsx(je,{required:!0,label:"Silenced by",value:o?.createdBy?.value,errortext:o?.createdBy?.error,onChange:p=>u({key:"createdBy",value:p.target.value}),disabled:!!m})}),e.jsx(L,{children:e.jsxs("div",{className:"grid gap-2 grid-cols-2",children:[e.jsx(Te,{value:o?.date?.start||i,dateFormat:"Y-m-d H:i:S",label:"Select a start date",enableTime:!0,time_24hr:!0,required:!0,errortext:o?.date?.error,onChange:c,enableSeconds:!0}),e.jsx(Te,{value:o?.date?.end||i,dateFormat:"Y-m-d H:i:S",label:"Select a end date",enableTime:!0,time_24hr:!0,required:!0,errortext:o?.date?.error,onChange:d,enableSeconds:!0})]})}),e.jsx(L,{children:e.jsx(Ze,{label:"Comment",value:o.comment.value,errortext:o.comment.error,onChange:p=>u({key:"comment",value:p.target.value}),required:!0})})]}),o?.editable_labels&&Object.keys(o?.editable_labels).length>0&&e.jsxs(ue,{children:[e.jsx(L,{children:e.jsx("p",{children:"Editable Labels are labels that are editable. You can use regular expressions."})}),e.jsx(L,{children:e.jsx("div",{className:"grid gap-2 grid-cols-2",children:Object.keys(o.editable_labels).map((p,$)=>e.jsx(je,{required:!0,label:p,id:p,value:o?.editable_labels[p].value,errortext:o?.editable_labels[p]?.error,onChange:b},$))})})]}),Object.keys(o?.fixed_labels).length>0&&e.jsxs(ue,{children:[e.jsx(L,{children:e.jsx("p",{children:"Fixed Labels are labels that are not editable."})}),e.jsx(L,{children:e.jsx(N,{gap:"2",alignment:"start",wrap:!0,className:"mt-2",children:Object.keys(o.fixed_labels).map((p,$)=>e.jsx(W,{pillKey:p,pillKeyLabel:p,pillValue:o?.fixed_labels[p],pillValueLabel:o?.fixed_labels[p]},$))})})]})]})]})," "]})}const Wr=()=>{const r=M(),t=_t(),a=Tt(),s=l=>{typeof l=="string"&&r({to:"/alerts",search:h=>({...h,predefinedFilter:l})})};return e.jsxs(N,{children:[n(),e.jsx("div",{className:"ml-auto",children:e.jsx(Jr,{})})]});function n(){return t&&a&&e.jsx(Ft,{activeItem:a,onActiveItemChange:s,children:t?.map(l=>e.jsx(Lt,{value:l.name,label:l.displayName},l.name))})}},Zr=()=>{const r=Nt(),t=kt(),{setAlertsData:a}=we(),{addMessage:s,resetMessages:n}=ae(),{data:l,isLoading:h,error:o}=ie("alerts");return o&&(n(),o instanceof Wt&&s({variant:"warning",text:e.jsx(Zt,{})}),s({variant:"error",text:oe(o)})),y.useEffect(()=>{l&&a({items:l.alerts,counts:l.counts})},[l]),e.jsx(e.Fragment,{children:h?e.jsxs(N,{gap:"2",children:[e.jsx("span",{children:"Loading"}),e.jsx(Y,{variant:"primary"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Wr,{}),e.jsx(zr,{}),e.jsx(Mr,{totalCounts:r,isUpdating:h,updatedAt:t}),e.jsx(Or,{})]})})};function ra(){const{appProps:{initialFilters:r},appStateFromUrl:{activeFilters:t,pausedFilters:a,predefinedFilter:s,searchTerm:n,showDetailsFor:l}}=$e.useRouteContext(),h=$e.useNavigate(),o=dt(),{setShowDetailsFor:u,setIsUrlRead:m}=ke(),{setActiveFilters:i,setPausedFilters:c,setActivePredefinedFilter:d,setSearchTerm:b}=G();return y.useLayoutEffect(()=>{!o&&!Ee(t)&&Ee(r)?(m(),h({to:"/alerts",replace:!0,search:p=>({...p,...Ve(q,r)})})):(i(t),c(a),s&&d(s),b(n),u(l),m())},[t,a,s,n,l]),e.jsxs(e.Fragment,{children:[e.jsx(ht,{children:e.jsx(Sr,{})}),e.jsx(Lr,{}),e.jsx(Zr,{})]})}export{ra as component};
