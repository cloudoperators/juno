import{j as e,i as x,d as c,e as v,Y as w,V as j,$ as D,f as h,u as P,g as E,s as R,J as S,H as y,P as b}from"./Shell-DfuFG_SJ.js";import{r as d}from"./index-GMEKmPRu.js";import{E as C}from"./ErrorMessage-CDOy3iYs.js";import"./index-CKLzlRSy.js";const f=({colSpan:n,children:r})=>e.jsx(x,{children:e.jsx(c,{colSpan:n,children:r})}),l=n=>n.status?.statusConditions?.conditions?.find(r=>r.type==="Ready"),B=({filterSettings:n,pluginPresetsPromise:r,colSpan:t})=>{const i=d.use(r)?.filter(s=>{if(!n?.searchTerm)return!0;const o=n.searchTerm.toLowerCase(),u=s.metadata?.name?.toLowerCase()||"",m=(s.spec?.plugin?.pluginDefinitionRef?.name||s.spec?.plugin?.pluginDefinition||"").toLowerCase();return u.includes(o)||m.includes(o)});return!i||i.length===0?e.jsx(f,{colSpan:t,children:"No plugin presets found."}):e.jsx(e.Fragment,{children:i.map((s,o)=>e.jsxs(x,{children:[e.jsx(c,{children:e.jsx(v,{icon:l(s)?.type==="Ready"&&l(s)?.status==="True"?"checkCircle":"error",color:l(s)?.type==="Ready"&&l(s)?.status==="True"?"text-theme-success":"text-theme-danger"})}),e.jsxs(c,{children:[s.status?.readyPlugins||0,"/",s.status?.totalPlugins||0]}),e.jsx(c,{children:s.metadata?.name}),e.jsx(c,{children:s.spec?.plugin?.pluginDefinitionRef.name||s.spec?.plugin?.pluginDefinition}),e.jsx(c,{children:l(s)?.type==="Ready"&&l(s)?.status!=="True"?l(s)?.message:""}),e.jsx(c,{className:"whitespace-nowrap",children:e.jsx(w,{size:"small",variant:"primary",children:"View details"})})]},o))})},N=({colSpan:n})=>e.jsx(f,{colSpan:n,children:e.jsx(j,{gap:"2",alignment:"center",children:e.jsx("div",{children:"Loading..."})})}),T=d.createContext(null),g={didCatch:!1,error:null};let k=class extends d.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=g}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var t,a,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];(t=(a=this.props).onReset)===null||t===void 0||t.call(a,{args:s,reason:"imperative-api"}),this.setState(g)}}componentDidCatch(r,t){var a,i;(a=(i=this.props).onError)===null||a===void 0||a.call(i,r,t)}componentDidUpdate(r,t){const{didCatch:a}=this.state,{resetKeys:i}=this.props;if(a&&t.error!==null&&L(r.resetKeys,i)){var s,o;(s=(o=this.props).onReset)===null||s===void 0||s.call(o,{next:i,prev:r.resetKeys,reason:"keys"}),this.setState(g)}}render(){const{children:r,fallbackRender:t,FallbackComponent:a,fallback:i}=this.props,{didCatch:s,error:o}=this.state;let u=r;if(s){const m={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")u=t(m);else if(a)u=d.createElement(a,m);else if(i!==void 0)u=i;else throw o}return d.createElement(T.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},u)}};function L(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return n.length!==r.length||n.some((t,a)=>!Object.is(t,r[a]))}const F=({children:n,displayErrorMessage:r,fallbackRender:t,resetKeys:a})=>e.jsx(k,{resetKeys:a,fallbackRender:r?t||C:()=>null,children:n}),M=({colspan:n})=>{const r=({error:t})=>e.jsx(f,{colSpan:n,children:e.jsx(j,{gap:"2",alignment:"center",children:e.jsx(C,{error:t})})});return r.displayName="ErrorDataRow",r},p=6,A=({filterSettings:n,pluginPresetsPromise:r})=>e.jsx("div",{className:"datagrid-hover",children:e.jsxs(D,{minContentColumns:[0,1,5],columns:p,children:[e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(v,{icon:"monitorHeart"})}),e.jsx(h,{children:"Instances"}),e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Plugin Definition"}),e.jsx(h,{children:"Message"}),e.jsx(h,{children:"Actions"})]}),e.jsx(F,{displayErrorMessage:!0,fallbackRender:M({colspan:p}),resetKeys:[r],children:e.jsx(d.Suspense,{fallback:e.jsx(N,{colSpan:p}),children:e.jsx(B,{filterSettings:n,pluginPresetsPromise:r,colSpan:p})})})]})}),K=()=>{const n=P(),{filterSettings:r}=E({from:"/admin/plugin-presets"}),t=d.useCallback(a=>{n({to:"/admin/plugin-presets",search:i=>({...i,searchTerm:a})})},[n]);return e.jsx(j,{direction:"vertical",gap:"4",className:"bg-theme-background-lvl-1 py-2 px-4",children:e.jsx(R,{children:e.jsx(S,{className:"w-96 ml-auto",placeholder:"Search plugin presets by name...",value:r?.searchTerm,onSearch:t,onClear:()=>t(void 0)})})})},H=()=>{const{pluginPresetsPromise:n,filterSettings:r}=E({from:"/admin/plugin-presets"});return e.jsxs(e.Fragment,{children:[e.jsxs(y,{px:!1,py:!0,children:[e.jsx(b,{children:"Plugin Presets Overview"}),e.jsx("p",{children:"Manage and monitor plugin preset configurations across all clusters"})]}),e.jsxs(y,{px:!1,py:!0,children:[e.jsx(K,{}),e.jsx(A,{filterSettings:r,pluginPresetsPromise:n})]})]})},Y=H;export{Y as component};
