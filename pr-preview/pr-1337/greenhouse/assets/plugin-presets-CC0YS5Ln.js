import{j as e,r as x,d as c,e as v,f as w,V as j,X as D,o as h,u as P,g as E,i as R,G as S,P as y,L as b}from"./Shell-CIJAb6np.js";import{r as d}from"./index-D7FSWLFb.js";import{E as C}from"./ErrorMessage-BtdysYSt.js";import"./index-DTNSntAP.js";const f=({colSpan:s,children:r})=>e.jsx(x,{children:e.jsx(c,{colSpan:s,children:r})}),l=s=>s.status?.statusConditions?.conditions?.find(r=>r.type==="Ready"),B=({filterSettings:s,pluginPresetsPromise:r,colSpan:t})=>{const i=d.use(r)?.filter(n=>{if(!s?.searchTerm)return!0;const o=s.searchTerm.toLowerCase(),u=n.metadata?.name?.toLowerCase()||"",m=(n.spec?.plugin?.pluginDefinitionRef?.name||n.spec?.plugin?.pluginDefinition||"").toLowerCase();return u.includes(o)||m.includes(o)});return!i||i.length===0?e.jsx(f,{colSpan:t,children:"No plugin presets found."}):e.jsx(e.Fragment,{children:i.map((n,o)=>e.jsxs(x,{children:[e.jsx(c,{children:e.jsx(v,{icon:l(n)?.type==="Ready"&&l(n)?.status==="True"?"checkCircle":"error",color:l(n)?.type==="Ready"&&l(n)?.status==="True"?"text-theme-success":"text-theme-danger"})}),e.jsxs(c,{children:[n.status?.readyPlugins||0,"/",n.status?.totalPlugins||0]}),e.jsx(c,{children:n.metadata?.name}),e.jsx(c,{children:n.spec?.plugin?.pluginDefinitionRef.name||n.spec?.plugin?.pluginDefinition}),e.jsx(c,{children:l(n)?.type==="Ready"&&l(n)?.status!=="True"?l(n)?.message:""}),e.jsx(c,{className:"whitespace-nowrap",children:e.jsx(w,{size:"small",variant:"primary",children:"View details"})})]},o))})},N=({colSpan:s})=>e.jsx(f,{colSpan:s,children:e.jsx(j,{gap:"2",alignment:"center",children:e.jsx("div",{children:"Loading..."})})}),L=d.createContext(null),g={didCatch:!1,error:null};let T=class extends d.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=g}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var t,a,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];(t=(a=this.props).onReset)===null||t===void 0||t.call(a,{args:n,reason:"imperative-api"}),this.setState(g)}}componentDidCatch(r,t){var a,i;(a=(i=this.props).onError)===null||a===void 0||a.call(i,r,t)}componentDidUpdate(r,t){const{didCatch:a}=this.state,{resetKeys:i}=this.props;if(a&&t.error!==null&&k(r.resetKeys,i)){var n,o;(n=(o=this.props).onReset)===null||n===void 0||n.call(o,{next:i,prev:r.resetKeys,reason:"keys"}),this.setState(g)}}render(){const{children:r,fallbackRender:t,FallbackComponent:a,fallback:i}=this.props,{didCatch:n,error:o}=this.state;let u=r;if(n){const m={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")u=t(m);else if(a)u=d.createElement(a,m);else if(i!==void 0)u=i;else throw o}return d.createElement(L.Provider,{value:{didCatch:n,error:o,resetErrorBoundary:this.resetErrorBoundary}},u)}};function k(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return s.length!==r.length||s.some((t,a)=>!Object.is(t,r[a]))}const F=({children:s,displayErrorMessage:r,fallbackRender:t,resetKeys:a})=>e.jsx(T,{resetKeys:a,fallbackRender:r?t||C:()=>null,children:s}),M=({colspan:s})=>{const r=({error:t})=>e.jsx(f,{colSpan:s,children:e.jsx(j,{gap:"2",alignment:"center",children:e.jsx(C,{error:t})})});return r.displayName="ErrorDataRow",r},p=6,A=({filterSettings:s,pluginPresetsPromise:r})=>e.jsx("div",{className:"datagrid-hover",children:e.jsxs(D,{minContentColumns:[0,1,5],columns:p,children:[e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(v,{icon:"monitorHeart"})}),e.jsx(h,{children:"Instances"}),e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Plugin Definition"}),e.jsx(h,{children:"Message"}),e.jsx(h,{children:"Actions"})]}),e.jsx(F,{displayErrorMessage:!0,fallbackRender:M({colspan:p}),resetKeys:[r],children:e.jsx(d.Suspense,{fallback:e.jsx(N,{colSpan:p}),children:e.jsx(B,{filterSettings:s,pluginPresetsPromise:r,colSpan:p})})})]})}),G=()=>{const s=P(),{filterSettings:r}=E({from:"/admin/plugin-presets"}),t=d.useCallback(a=>{s({to:"/admin/plugin-presets",search:i=>({...i,searchTerm:a})})},[s]);return e.jsx(j,{direction:"vertical",gap:"4",className:"bg-theme-background-lvl-1 py-2 px-4",children:e.jsx(R,{children:e.jsx(S,{className:"w-96 ml-auto",placeholder:"Search plugin presets by name...",value:r?.searchTerm,onSearch:t,onClear:()=>t(void 0)})})})},K=()=>{const{pluginPresetsPromise:s,filterSettings:r}=E({from:"/admin/plugin-presets"});return e.jsxs(e.Fragment,{children:[e.jsxs(y,{px:!1,py:!0,children:[e.jsx(b,{children:"Plugin Presets Overview"}),e.jsx("p",{children:"Manage and monitor plugin preset configurations across all clusters"})]}),e.jsxs(y,{px:!1,py:!0,children:[e.jsx(G,{}),e.jsx(A,{filterSettings:r,pluginPresetsPromise:s})]})]})},H=K;export{H as component};
