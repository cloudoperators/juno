query GetServiceImageVersionIssues($componentVersionFilter: ComponentVersionFilter, $issueMatchFilter: IssueMatchFilter, $first: Int, $after: String, $orderBySeverity: [IssueMatchOrderBy], $orderByTrd: [IssueMatchOrderBy]) {
  ComponentVersions(filter: $componentVersionFilter) {
    edges {
      node {
        issues(first: $first, after: $after) {
          edges {
            node {
              issueVariants(first: 1) {
                edges{
                  node{
                    externalUrl
                  }
                }
              }
              primaryName
              description
              highestSeverity: issueMatches(
                filter: $issueMatchFilter
                first: 1
                orderBy: $orderBySeverity
              ) {
                totalCount
                edges {
                  node {
                    severity {
                      value
                      cvss{
                        vector
                        externalUrl
                      }
                    }
                  }
                }
              }
              earliestTargetRemediationDate: issueMatches(
                filter: $issueMatchFilter
                first: 1
                orderBy: $orderByTrd
              ) {
                edges {
                  node {
                    targetRemediationDate
                  }
                }
              }
            }
          }
        }
      }
    }
    totalCount
    pageInfo {
      pages {
        after
        pageNumber
      }
    }
  }
}