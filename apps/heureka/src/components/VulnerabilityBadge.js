import React, { useMemo } from "react"
import { Badge, Icon } from "juno-ui-components"
import {
  THREAD_LEVEL_LOW,
  THREAD_LEVEL_MEDIUM,
  THREAD_LEVEL_HIGH,
  THREAD_LEVEL_CRITICAL,
} from "../helpers"

const badgeCss = `
  mr-2
`

const badgeContainerCss = (label) => {
  return `
			${label && `min-w-[2.3rem]`}
      flex
      items-center  
		`
    .replace(/\n/g, " ")
    .replace(/\s+/g, " ")
}

const textCss = `
  text-center
  w-full
`

const iconCss = (label) => {
  return `
			${label && `mr-1`}
      mt-0.5
		`
    .replace(/\n/g, " ")
    .replace(/\s+/g, " ")
}

const VulnerabilityBadge = ({ level, label }) => {
  const icon = useMemo(() => {
    const threadLevel = level || ""
    switch (threadLevel.toLowerCase()) {
      case THREAD_LEVEL_LOW:
        return "severityLow"
      case THREAD_LEVEL_MEDIUM:
        return "severityMedium"
      case THREAD_LEVEL_HIGH:
        return "severityHigh"
      case THREAD_LEVEL_CRITICAL:
        return "severityCritical"
    }
  }, [level])

  const badgeVariant = useMemo(() => {
    const threadLevel = level || ""
    switch (threadLevel.toLowerCase()) {
      case THREAD_LEVEL_LOW:
        return ""
      case THREAD_LEVEL_MEDIUM:
        return "warning"
      case THREAD_LEVEL_HIGH:
        return "danger"
      case THREAD_LEVEL_CRITICAL:
        return "critical"
    }
  }, [level])

  return (
    <Badge variant={badgeVariant} className={badgeCss}>
      <div className={badgeContainerCss(label)}>
        <div className="flex">
          <Icon className={iconCss(label)} size="16" icon={icon} />
        </div>
        {label && <span className={textCss}>{label}</span>}
      </div>
    </Badge>
  )
}

export default VulnerabilityBadge
